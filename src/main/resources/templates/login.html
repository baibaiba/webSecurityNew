<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>登录</title>
    <link rel="stylesheet" href="../static/layui/css/layui.css" type="text/css">
    <script src="../static/jquery-3.5.1.min.js" type="text/javascript"></script>
    <script src="../static/layui/layui.js" type="text/javascript"></script>
</head>
<body>
<div class="layer_form">
    <div class="form_item">
        <label>手机号码：</label>
        <div class="form_item_input">
            <input type="text" id="username" placeholder="手机号码" class="input_long"/>
        </div>
    </div>
    <div class="form_item">
        <label>密 码：</label>
        <div class="form_item_input">
            <input type="password" id="password" placeholder="请输入密码" class="input_long"/>
        </div>
    </div>
    <div class="form_item">
        <div class="form_item_input">
            <input type="button" id="login" placeholder="登录" onclick="login()" class="input_long" value="登录"/>
        </div>
    </div>
</div>
</body>
<script type="text/javascript">
    //一般直接写在一个js文件中
    function login() {
        var username = $("#username").val();
        var password = $("#password").val();
        var json = {
            userAccount: $.trim(username),
            password: $.trim(password)
        };

        if (json.userAccount === "") {
            layer.alert("请输入用户名");
            return;
        }

        if (json.password === "") {
            layer.alert("请输入密码");
            return;
        }
        debugger;

        $.ajax({
            url: "loginin",
            data: JSON.stringify(json),
            beforeSend: function (request) {
                request.setRequestHeader("Content-Type", "application/json");
            },
            type: "post",
            success: function (data) {
                if (data.code === 0) {
                    layer.alert(data.message);
                    return;
                }

                if (data.busCode === "1001") {
                    layer.open({
                        type: 1,
                        title: ['修改初始登录密码'],
                        area: ['480px', '300px'],
                        content: $("#divChangePwd")
                    });
                    userId = data.data;
                    return;
                }
                // 登录成功跳转
                rememberCookie(json.userAccount);
                var url = data.data;
                window.location.href = url;
            }
        })
    }
</script>
</html>